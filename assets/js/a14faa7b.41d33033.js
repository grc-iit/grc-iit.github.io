"use strict";(self.webpackChunkgrc=self.webpackChunkgrc||[]).push([[1818],{2005:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"jarvis/jarvis-cd/index","title":"Jarvis-CD","description":"Jarvis-CD is a unified platform for deploying various applications, including","source":"@site/docs/05-jarvis/02-jarvis-cd/01-index.md","sourceDirName":"05-jarvis/02-jarvis-cd","slug":"/jarvis/jarvis-cd/index","permalink":"/docs/jarvis/jarvis-cd/index","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Hostfile","permalink":"/docs/jarvis/jarvis-util/hostfile"},"next":{"title":"Getting Started","permalink":"/docs/jarvis/jarvis-cd/getting-started"}}');var a=i(74848),t=i(28453);const r={},o="Jarvis-CD",l={},c=[{value:"Installation",id:"installation",level:2},{value:"Building the Jarvis Configuration",id:"building-the-jarvis-configuration",level:2},{value:"Bootstrapping for a single-node machine",id:"bootstrapping-for-a-single-node-machine",level:3},{value:"Bootstrapping from a specific machine",id:"bootstrapping-from-a-specific-machine",level:3},{value:"Creating a new configuration",id:"creating-a-new-configuration",level:3},{value:"Set the active Hostfile",id:"set-the-active-hostfile",level:2},{value:"Building the Resource Graph",id:"building-the-resource-graph",level:2},{value:"Manual Installation (Mainly Devs)",id:"manual-installation-mainly-devs",level:2},{value:"Jarvis-Util",id:"jarvis-util",level:3},{value:"Scspkg",id:"scspkg",level:3},{value:"Jarvis-CD",id:"jarvis-cd-1",level:3},{value:"Net Test",id:"net-test",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"jarvis-cd",children:"Jarvis-CD"})}),"\n",(0,a.jsx)(n.p,{children:"Jarvis-CD is a unified platform for deploying various applications, including\nstorage systems and benchmarks. Many applications have complex configuration\nspaces and are difficult to deploy across different machines."}),"\n",(0,a.jsx)(n.p,{children:'We provide a builtin repo which contains various applications to deploy.\nWe refer to applications as "jarivs pkgs" which can be connected to form\n"deployment pipelines".'}),"\n",(0,a.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,a.jsx)(n.p,{children:"Get the GRC spack repo (if you haven't already):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/grc-iit/grc-repo\nspack repo add grc-repo\n"})}),"\n",(0,a.jsx)(n.p,{children:"Install jarvis-cd:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"spack external find python\nspack install py-jarvis-cd\n"})}),"\n",(0,a.jsx)(n.p,{children:"Spack packages must be loaded to use them.\nYou'll have to do this for each new terminal."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"spack load py-jarvis-cd\n"})}),"\n",(0,a.jsx)(n.h2,{id:"building-the-jarvis-configuration",children:"Building the Jarvis Configuration"}),"\n",(0,a.jsx)(n.h3,{id:"bootstrapping-for-a-single-node-machine",children:"Bootstrapping for a single-node machine"}),"\n",(0,a.jsx)(n.p,{children:"You may be trying to test things on just a single node."}),"\n",(0,a.jsx)(n.p,{children:"In this case, run:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"jarvis bootstrap from local\n"})}),"\n",(0,a.jsx)(n.h3,{id:"bootstrapping-from-a-specific-machine",children:"Bootstrapping from a specific machine"}),"\n",(0,a.jsx)(n.p,{children:"Jarvis has been pre-configured on some machines. To bootstrap from\none of them, run the following:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"jarvis bootstrap from ares\n"})}),"\n",(0,a.jsx)(n.p,{children:"NOTE: Jarvis must be installed from the compute nodes in Ares, NOT the master node. This is because we store configuration data in /mnt/ssd by default, which is only on compute nodes. We do not store data in /tmp since it will be eventually destroyed."}),"\n",(0,a.jsx)(n.p,{children:"To check the set of available machines to bootstrap from, run:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"jarvis bootstrap list\n"})}),"\n",(0,a.jsx)(n.h3,{id:"creating-a-new-configuration",children:"Creating a new configuration"}),"\n",(0,a.jsx)(n.p,{children:"A configuration can be generated as follows:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"jarvis init [CONFIG_DIR] [PRIVATE_DIR] [SHARED_DIR (optional)]\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"CONFIG_DIR:"})," A directory where jarvis metadata for pkgs and pipelines\nare stored. This directory can be anywhere that the current user can access."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"PRIVATE_DIR:"})," A directory which is common across all machines, but\nstores data locally to the machine. Some jarvis pkgs require certain data to\nbe stored per-machine. OrangeFS is an example."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"SHARED_DIR:"})," A directory which is common across all machines, where\neach machine has the same view of data in the directory. Most jarvis pkgs\nrequire this, but on machines without a global filesystem (e.g., Chameleon Cloud),\nthis parameter can be set later."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"For a personal machine, these directories can be the same directory."}),"\n",(0,a.jsx)(n.h2,{id:"set-the-active-hostfile",children:"Set the active Hostfile"}),"\n",(0,a.jsx)(n.p,{children:"The hostfile contains the set of nodes that the pipeline will run over.\nThis is structured the same way as a traditional MPI hostfile."}),"\n",(0,a.jsx)(n.p,{children:"An example hostfile:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-txt",children:"ares-comp-20\nares-comp-[21-25]\n"})}),"\n",(0,a.jsx)(n.p,{children:"To set the active hostfile, run:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"jarvis hostfile set /path/to/hostfile\n"})}),"\n",(0,a.jsx)(n.p,{children:"Note that every time you change the hostfile, you will need to update the\npipeline. Jarvis does not automatically detect changes to this file."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"jarvis ppl update\n"})}),"\n",(0,a.jsx)(n.h2,{id:"building-the-resource-graph",children:"Building the Resource Graph"}),"\n",(0,a.jsxs)(n.p,{children:["NOTE: This step only needs to be run if you did ",(0,a.jsx)(n.code,{children:"jarvis bootstrap from local"})," or ",(0,a.jsx)(n.code,{children:"jarvis init"}),".\nIf you bootstrap from a specific machine, then skip this section."]}),"\n",(0,a.jsx)(n.p,{children:"The resource graph is a snapshot of your systems network and storage.\nMany packages depend on it for their configurations. The Hermes I/O system, for example,\nuses this to identify valid networks and buffering locations."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"jarvis rg build\n"})}),"\n",(0,a.jsx)(n.h2,{id:"manual-installation-mainly-devs",children:"Manual Installation (Mainly Devs)"}),"\n",(0,a.jsx)(n.h3,{id:"jarvis-util",children:"Jarvis-Util"}),"\n",(0,a.jsx)(n.p,{children:"Jarvis-CD depends on jarvis-util. jarvis-util contains functions to execute\nbinaries in python and collect their output."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/grc-iit/jarvis-util.git\ncd jarvis-util\npython3 -m pip install -r requirements.txt\npython3 -m pip install -e .\n"})}),"\n",(0,a.jsx)(n.h3,{id:"scspkg",children:"Scspkg"}),"\n",(0,a.jsx)(n.p,{children:"Scspkg is a tool for building modulefiles using a CLI. It's not strictly\nnecessary for Jarvis to function, but many of the readmes use it to provide\nstructure to manual installations."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'git clone https://github.com/grc-iit/scspkg.git\npython3 -m pip install -r requirements.txt\npython3 -m pip install -e .\necho "module use \\`scspkg module dir\\`" >> ~/.bashrc\n'})}),"\n",(0,a.jsxs)(n.p,{children:["The wiki for scspkg is ",(0,a.jsx)(n.a,{href:"https://github.com/grc-iit/scspkg.git",children:"here"}),"."]}),"\n",(0,a.jsx)(n.h3,{id:"jarvis-cd-1",children:"Jarvis-CD"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cd /path/to/jarvis-cd\npython3 -m pip install -r requirements.txt\npython3 -m pip install -e .\n"})}),"\n",(0,a.jsx)(n.h3,{id:"net-test",children:"Net Test"}),"\n",(0,a.jsx)(n.p,{children:"Network test tool for identifying valid networks."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"spack install chi-nettest\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>o});var s=i(96540);const a={},t=s.createContext(a);function r(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);