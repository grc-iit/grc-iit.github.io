"use strict";(self.webpackChunkgrc=self.webpackChunkgrc||[]).push([[23699],{25753:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"jarvis/jarvis-cd/design-motivation","title":"Design & Motivation","description":"First we will describe how jarvis-cd is organized and the files that it creates.","source":"@site/docs/81-jarvis/02-jarvis-cd/04-design-motivation.md","sourceDirName":"81-jarvis/02-jarvis-cd","slug":"/jarvis/jarvis-cd/design-motivation","permalink":"/docs/jarvis/jarvis-cd/design-motivation","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Resource Graph","permalink":"/docs/jarvis/jarvis-cd/resource-graph"},"next":{"title":"Pipeline Scripts","permalink":"/docs/jarvis/jarvis-cd/pipeline-scripts"}}');var r=n(74848),a=n(28453);const t={},l="Design & Motivation",o={},c=[{value:"Jarvis Config",id:"jarvis-config",level:2},{value:"<code>Pkg</code>s",id:"pkgs",level:2},{value:"Pipelines",id:"pipelines",level:2},{value:"Service Pkgs",id:"service-pkgs",level:2},{value:"Application Pkgs",id:"application-pkgs",level:2},{value:"Interceptor Pkgs",id:"interceptor-pkgs",level:2},{value:"Pipeline Metadata",id:"pipeline-metadata",level:2}];function d(e){const i={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.header,{children:(0,r.jsx)(i.h1,{id:"design--motivation",children:"Design & Motivation"})}),"\n",(0,r.jsxs)(i.p,{children:["First we will describe how ",(0,r.jsx)(i.code,{children:"jarvis-cd"})," is organized and the files that it creates."]}),"\n",(0,r.jsx)(i.h2,{id:"jarvis-config",children:"Jarvis Config"}),"\n",(0,r.jsxs)(i.p,{children:["The Jarvis configuration file is stored under ",(0,r.jsx)(i.code,{children:"${JARVIS_ROOT}/config/jarvis_config.yaml"}),".\nIt stores the ",(0,r.jsx)(i.code,{children:"${CONFIG_DIR}"}),", ",(0,r.jsx)(i.code,{children:"${PRIVATE_DIR}"}),", and ",(0,r.jsx)(i.code,{children:"${SHARED_DIR}"})," variables described in the Home page.\nAdditionally, it stores the currently-active hostfile and the set of repos to search for pkgs.\nThis file essentially determines where Jarvis will store metadata for pipelines."]}),"\n",(0,r.jsxs)(i.p,{children:["The resource graph for the current machine is stored under ",(0,r.jsx)(i.code,{children:"${JARVIS_ROOT}/config/resource_graph.yaml"}),".\nThe resource graph stores information about the machine state, including hardware and networks."]}),"\n",(0,r.jsxs)(i.h2,{id:"pkgs",children:[(0,r.jsx)(i.code,{children:"Pkg"}),"s"]}),"\n",(0,r.jsxs)(i.p,{children:['Jarvis-cd deploys complex applications. In Jarvis, we consider applications\n"',(0,r.jsx)(i.code,{children:"pkg"}),'s". ',(0,r.jsx)(i.code,{children:"Pkg"}),"s can be connected to form a pipeline, which is a series of\napplications to deploy all at once."]}),"\n",(0,r.jsxs)(i.p,{children:["Jarvis has three general ",(0,r.jsx)(i.code,{children:"pkg"})," types:"]}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsx)(i.li,{children:"Service: a program which runs forever, until forcibly stopped."}),"\n",(0,r.jsx)(i.li,{children:"Application: a program which runs to a definite completion.\nFor example, run IOR over OrangeFS, BeeGFS, and Hermes."}),"\n",(0,r.jsx)(i.li,{children:"Interceptor: Used to intercept code for a benchmark or storage system."}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"pipelines",children:"Pipelines"}),"\n",(0,r.jsx)(i.p,{children:"Jarvis-cd provides a CLI to create pipelines. A pipeline specifies an\nordered set of configured pkgs to execute. An example of a jarvis pipeline\nwould be as follows:"}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.img,{alt:"example-pipeline",src:n(10045).A+"",width:"962",height:"128"})}),"\n",(0,r.jsx)(i.h2,{id:"service-pkgs",children:"Service Pkgs"}),"\n",(0,r.jsx)(i.p,{children:"Service pkgs represent long-running applications. An example would be a storage system."}),"\n",(0,r.jsx)(i.p,{children:"Storage systems have complex configurations:"}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsx)(i.li,{children:"What pkgs do metadata servers go on?"}),"\n",(0,r.jsx)(i.li,{children:"What pkgs do storage server go on?"}),"\n",(0,r.jsx)(i.li,{children:"What storage devices do we use?"}),"\n",(0,r.jsx)(i.li,{children:"What interface should the storage device expose? Filesystem? Block device?"}),"\n",(0,r.jsx)(i.li,{children:"What networking protocol do we use?"}),"\n",(0,r.jsx)(i.li,{children:"How many threads to use?"}),"\n",(0,r.jsx)(i.li,{children:"The list goes on and on."}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:"To make matters worse, each storage system has different ways to represent this\ninformation. Each machine has different paths, different network cards,\ndifferent IPs, etc. How do we simplify the deployment of these complex systems?"}),"\n",(0,r.jsxs)(i.p,{children:["At the end of the day, there's no way to get around having a configuration\nfile. For each storage system, we store configuration files. These\nfiles are stored in the ",(0,r.jsx)(i.code,{children:"${PRIVATE_DIR}"})," and ",(0,r.jsx)(i.code,{children:"${SHARED_DIR}"})," directories stored\nin the jarvis configuration."]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"jarvis ppl create ofs-global\njarvis ppl append orangefs\njarvis ppl start &\njarvis ppl stop\n"})}),"\n",(0,r.jsx)(i.h2,{id:"application-pkgs",children:"Application Pkgs"}),"\n",(0,r.jsx)(i.p,{children:"Applications can include:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"benchmarks"}),"\n",(0,r.jsx)(i.li,{children:"simulation codes"}),"\n"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"jarvis ppl create my-benchmark\njarvis cd my-benchmark\njarvis ppl append orangefs\njarvis ppl append hermes\njarvis ppl append ior\n"})}),"\n",(0,r.jsx)(i.h2,{id:"interceptor-pkgs",children:"Interceptor Pkgs"}),"\n",(0,r.jsx)(i.p,{children:"A library can be used to intercept or monitor some functionality of an\napplication. For example, a library may include"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"jarvis ppl create my-app\njarvis cd my-app\njarvis ppl append orangefs \\\n  client_path=${HOME}/llogan/pfs\njarvis ppl append hermes\njarvis ppl append monitor\njarvis ppl append qmcpack\njarvis ppl run\n"})}),"\n",(0,r.jsx)(i.h2,{id:"pipeline-metadata",children:"Pipeline Metadata"}),"\n",(0,r.jsxs)(i.p,{children:["When creating a pipeline, metadata for the pipeline will be created under\nthe ",(0,r.jsx)(i.code,{children:"${CONFIG_DIR}"})," from the jarvis config."]}),"\n",(0,r.jsx)(i.p,{children:"The metadata for the currently-focused pipeline."}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"jarvis create my-pipeline\nls `jarvis path`\n"})}),"\n",(0,r.jsxs)(i.p,{children:["This will print all folders and files relevant to ",(0,r.jsx)(i.code,{children:"my-pipeline"}),"."]}),"\n",(0,r.jsx)(i.p,{children:"When adding pkgs to the pipeline, sub-folders will be created for each individual pkg.\nFor example, the following will print all files used by the hermes pkg."}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-bash",children:"jarvis append hermes\nls `jarvis path`/hermes\n"})})]})}function p(e={}){const{wrapper:i}={...(0,a.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},10045:(e,i,n)=>{n.d(i,{A:()=>s});const s=n.p+"assets/images/pipeline-21a856e8de047016ac3c349d400a9942.svg"},28453:(e,i,n)=>{n.d(i,{R:()=>t,x:()=>l});var s=n(96540);const r={},a=s.createContext(r);function t(e){const i=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(a.Provider,{value:i},e.children)}}}]);