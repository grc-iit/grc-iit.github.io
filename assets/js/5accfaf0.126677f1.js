"use strict";(self.webpackChunkgrc=self.webpackChunkgrc||[]).push([[5206],{6175:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"iowarp/components/content-transfer-engine/developer-guide","title":"Developer Guide","description":"Hermes can be complicated to debug due to its distributed and asynchronous","source":"@site/docs/11-iowarp/03-components/05-content-transfer-engine/10-developer-guide.md","sourceDirName":"11-iowarp/03-components/05-content-transfer-engine","slug":"/iowarp/components/content-transfer-engine/developer-guide","permalink":"/docs/iowarp/components/content-transfer-engine/developer-guide","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Topology","permalink":"/docs/iowarp/components/content-transfer-engine/components/topology"},"next":{"title":"Doxygen","permalink":"/docs/iowarp/components/content-transfer-engine/doxygen"}}');var s=t(74848),i=t(28453);const o={},a="Developer Guide",l={},c=[{value:"Hermes Repo Structure",id:"hermes-repo-structure",level:2},{value:"Preparing Pull Request (PR)",id:"preparing-pull-request-pr",level:2},{value:"PR Check Failure",id:"pr-check-failure",level:2},{value:"Remote Debugging",id:"remote-debugging",level:2},{value:"Preparing For Release",id:"preparing-for-release",level:2},{value:"Introduction to our Continuous Integration (CI)",id:"introduction-to-our-continuous-integration-ci",level:2},{value:"Adding a New Adapter",id:"adding-a-new-adapter",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"developer-guide",children:"Developer Guide"})}),"\n",(0,s.jsx)(n.p,{children:"Hermes can be complicated to debug due to its distributed and asynchronous\nnature. Faults can happen in the client program, or in the Hermes daemon.\nThe first step when encountering problems is to compile in Debug mode."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cmake",children:"cmake .. -DCMAKE_BUILD_TYPE=Debug\n"})}),"\n",(0,s.jsx)(n.p,{children:"The Debug mode will increase the number of logging statements the program\nuses to give you a stronger hint as to where the problem occurs. These\nstatements are typically compiled out for performance reasons."}),"\n",(0,s.jsx)(n.p,{children:"Secondly, make sure to use an IDE which supports visual debugging. Debugging\nusing a terminal with gdb can be very cumbersome, especially when multi-process cases come along."}),"\n",(0,s.jsx)(n.h2,{id:"hermes-repo-structure",children:"Hermes Repo Structure"}),"\n",(0,s.jsx)(n.p,{children:"The Hermes repo is organized as follows:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"tasks/hermes_core"})," contains the majority of Hermes implementation. These are tasks that execute in the Hermes runtime"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"src"})," contains a single source file that is used to construct the Hermes library object that applications link to. Very little code is here, as most implementation is executed in the runtime."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"hermes_adapters"})," includes all code relating to the adapters, such as  POSIX, STDIO, and MPI-IO interception"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"config"})," contains default configurations of Hermes."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"wrapper"})," contains all code for binding Hermes to other languages."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"test"})," includes all unit tests"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"benchmark"})," includes some performance benchmark kernels"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ci"})," includes all code for continuous integration"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"preparing-pull-request-pr",children:"Preparing Pull Request (PR)"}),"\n",(0,s.jsx)(n.p,{children:"Please run these two steps and remove all warnings."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"make dox\nmake lint\n"})}),"\n",(0,s.jsx)(n.h2,{id:"pr-check-failure",children:"PR Check Failure"}),"\n",(0,s.jsxs)(n.p,{children:["We use the ",(0,s.jsx)(n.a,{href:"https://github.com/HDFGroup/hermes/blob/master/docker/deps.Dockerfile",children:"deps.Dockerfile"}),"\nto avoid reinstalling packages in the github action. While github has a cache action,\nwe find it somewhat cumbersome. This way, we get the benefit of both a maintained\ndockerfile and a fast github action."]}),"\n",(0,s.jsx)(n.h2,{id:"remote-debugging",children:"Remote Debugging"}),"\n",(0,s.jsx)(n.p,{children:"IDEs like VSCode have modules for connecting to remote machines.\nThey will allow you to install their debuggers, such as gdb."}),"\n",(0,s.jsxs)(n.p,{children:["Below is an example ",(0,s.jsx)(n.code,{children:"~/.ssh/config"})," file that allows you to\nconnect to the Ares machine's 4th compute node."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"Host ares-comp\n  HostName ares-comp-04\n  User llogan\n  ProxyJump ares.cs.iit.edu\n"})}),"\n",(0,s.jsxs)(n.p,{children:["In vscode, you can install Remote-SSH module to connect via the ",(0,s.jsx)(n.code,{children:"ares-comp"})," name."]}),"\n",(0,s.jsx)(n.p,{children:"You may also want to install a pretty print for gdb on the remote server if it's Linux:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mkdir -p ~/distribs/gdb_printers\ncd ~/distribs/gdb_printers\nsvn co svn://gcc.gnu.org/svn/gcc/trunk/libstdc++-v3/python\necho \"python\nimport sys \nsys.path.insert(0, '${HOME}/distribs/gdb_printers/python')\nfrom libstdcxx.v6.printers import register_libstdcxx_printers\nregister_libstdcxx_printers (None)\nend\" > ~/.gdbinit\n"})}),"\n",(0,s.jsx)(n.h2,{id:"preparing-for-release",children:"Preparing For Release"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Create a GitHub Project for the ",(0,s.jsx)(n.em,{children:"next"})," release"]}),"\n",(0,s.jsxs)(n.li,{children:["Update the ",(0,s.jsx)(n.code,{children:"HERMES_VERSION_*"})," variables in ",(0,s.jsx)(n.code,{children:"CMakeLists.txt"})]}),"\n",(0,s.jsxs)(n.li,{children:["Update ",(0,s.jsx)(n.code,{children:"PROJECT_NUMBER"})," in ",(0,s.jsx)(n.code,{children:"Doxyfile.in"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"To make release note generation as automated as possible, make sure\nrelevant pull requests that are part of the release have proper labels and and\ntitles, as that information will show up directly in the generated release\nnotes in the next step."}),"\n",(0,s.jsxs)(n.li,{children:["Draft a release on Github. Click ",(0,s.jsx)(n.code,{children:"auto-generate release notes"}),' and edit\nthe result as necessary. Fill in the new tag, and select "Create new tag x.x.x\non publish" so that Github will automatically tag the release when it is\npublished.']}),"\n",(0,s.jsx)(n.li,{children:"The docker containers will be automatically built and pushed to docker hub\nwhenever a new tag is added. Check the CI actions to make sure there were no\nerrors."}),"\n",(0,s.jsx)(n.li,{children:"Copy/move ideas to the project for the next release"}),"\n",(0,s.jsxs)(n.li,{children:["Close and archive the project for the ",(0,s.jsx)(n.em,{children:"current"})," release"]}),"\n",(0,s.jsxs)(n.li,{children:["Merge the latest release branch (if one exists) of the wiki into the ",(0,s.jsx)(n.code,{children:"master"})," branch."]}),"\n",(0,s.jsx)(n.li,{children:"Make an announcement in the Hermes topic of the HDF forum."}),"\n",(0,s.jsx)(n.li,{children:"Send Lori a note for the next HDF5 newsletter."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"introduction-to-our-continuous-integration-ci",children:"Introduction to our Continuous Integration (CI)"}),"\n",(0,s.jsxs)(n.p,{children:["We are primarily using Python for managing for running unit tests. Under\n",(0,s.jsx)(n.a,{href:"https://github.com/HDFGroup/hermes/blob/master/CMakeLists.txt",children:"our root CMakeList"}),", we implement a\nCMake function called jarvis_test, which uses ",(0,s.jsx)(n.a,{href:"https://github.com/grc-iit/jarvis-cd.git",children:"Jarvis"}),"\nand its ",(0,s.jsx)(n.a,{href:"https://github.com/HDFGroup/hermes/tree/master/test/unit/pipelines",children:"pipelines"})," concept."]}),"\n",(0,s.jsx)(n.h2,{id:"adding-a-new-adapter",children:"Adding a New Adapter"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Create a new directory under the ",(0,s.jsx)(n.code,{children:"adapter"})," directory."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var r=t(96540);const s={},i=r.createContext(s);function o(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);